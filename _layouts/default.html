<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.title | default: site.name }}</title>
  <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | strip_newlines | truncate: 160 }}" />
  <link rel="stylesheet" href="{{ '/assets/css/hacker.css' | relative_url }}" />
</head>
<body class="minimal">
  <!-- Matrix canvas (only visible in Matrix modes) -->
  <canvas id="matrixCanvas"></canvas>

  <div class="toolbar wrapper">
    <div class="brand">$ ./{{ site.title | default: 'blog' | downcase | replace: ' ', '_' }} <span class="cursor">█</span></div>
    <button class="btn" data-mode="minimal" aria-pressed="true">Minimal</button>
    <button class="btn" data-mode="sidebar">Sidebar</button>
    <button class="btn" data-mode="matrix">Matrix</button>
    <button class="btn" data-mode="sidebarMatrix">Sidebar + Matrix</button>
    <span class="badge">Green-on-Black · Courier New</span>
  </div>

  <div class="wrapper layout">
    <main class="content" id="content">
      <header>
        <h1>{{ page.title | default: site.title }}</h1>
        {% if page.subtitle %}<p class="subtitle">{{ page.subtitle }}</p>{% endif %}
        {% if page.layout == 'home' and site.description %}<p>{{ site.description }}</p>{% endif %}
      </header>

      {{ content }}

      <footer class="site-footer">
        <small>© {{ site.time | date: "%Y" }} {{ site.author.name | default: site.author | default: site.title }}</small>
      </footer>
    </main>
  </div>

  <script src="{{ '/assets/js/matrix.js' | relative_url }}" defer></script>
  <script>
    // Mode toggling (default is Minimal = plain black/green)
    document.addEventListener('DOMContentLoaded', () => {
      const buttons = document.querySelectorAll('.btn[data-mode]');
      const setMode = (mode) => {
        document.body.className = mode;
        buttons.forEach(b => b.setAttribute('aria-pressed', String(b.dataset.mode === mode)));
        try { localStorage.setItem('hacker_mode', mode); } catch(_) {}
      };
      const saved = (localStorage && localStorage.getItem('hacker_mode')) || 'minimal';
      setMode(saved);
      buttons.forEach(btn => btn.addEventListener('click', () => setMode(btn.dataset.mode)));
    });
  </script>
</body>
</html>
